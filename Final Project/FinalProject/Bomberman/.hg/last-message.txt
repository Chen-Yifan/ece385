Lots of comments added. Unused entities removed.